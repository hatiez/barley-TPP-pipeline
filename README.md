# Prediction of Harvest-Related Traits in Barley Using High-Throughput Phenotyping and Machine Learning

This repository accompanies the project **"Prediction of harvest-related traits in barley using high-throughput phenotyping data and machine learning."**

**[Publication (Coming Soon)](TODO)** — Please refer to the publication for background, methodology, and results.

**Contributors:** Hans Tietze, Lamis Abdelhakim and Barbora Pleskačová.

---

## Repository Structure

- **`PublData/`**  
  Contains all raw and processed phenotyping and harvest data files required to run the analysis.

- **`Rscripts/`**  
  Includes all analysis scripts and their corresponding function files (if present). Functions are loaded in the main script and do not need to be opened. Files are organized by stage in the pipeline:

  - **Preprocessing**  
    - `preProcessing.R`

  - **Tolerance Ranking**  
    - `ToleranceRanking.R`  
    - `ToleranceRankingFunctions.R`

  - **Clustering of Samples**  
    - `clusteringSamples.R`

  - **Variance Decomposition**  
    - `varianceDecomp.R`  
    - `varianceDecompFunctions.R`

  - **Treatment Classification (TPC)**  
    - `TreatmentClassification.R`  
    - `TreatmentClassificationFunctions.R`

  - **Harvest Trait Prediction (TPP)**  
    - `RFHarvestPrediction.R`  
    - `LASSOHarvestPrediction.R`  
    - `RFHarvestPredictionFunctions.R`  
    - `LASSOHarvestPredictionFunctions.R`

  - **Model Evaluation**  
    - `HarvestPredictionEvaluation.R`  
    - `HarvestPredictionEvaluationFunctions.R`

- **`Rout/`**  
  This directory is auto-generated by the scripts to store outputs from the analysis. If not present, it will be created when you run a script.

---

## Running the Pipeline

1. **Install dependencies**  
   Each script checks for and offers to install any required packages if they're missing.

2. **Run pre-processing first**  
   You must run `preProcessing.R` before using any downstream scripts, as many depend on pre-processed data.

3. **Follow analysis stages**  
   - Run tolerance ranking, variance decomposition, or classification independently.
   - For TPP model evaluation, make sure to first generate the prediction models using the RF and LASSO scripts or download the models we trained for the project and place them in `Rout/mlModels/`.

---

## Model Availability

Due to size constraints, trained machine learning models for TPP and TPC are hosted externally and can be downloaded here:

**[Download Pretrained Models (Google Drive)](https://drive.google.com/drive/folders/1n1tJrRs1ut-vltn8wqGUT2DSloA8HgIp?usp=sharing)**

Place the downloaded model files in the directory `Rout/mlModels/` for compatibility with the evaluation scripts.

---

## Notes

- All files use consistent naming and directory structure — do not change these unless you modify the scripts accordingly.

---
